'use strict';

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

Object.defineProperty(exports, '__esModule', {
    value: true
});

var _fs = require('fs');

var _fs2 = _interopRequireDefault(_fs);

var WGXPATH_PATH = require.resolve('wgxpath');

var wgxpathSrc = undefined;

/**
 * Ensures document.evaluate() in the browser.
 */
var ensureClientSideSelectorSupport = function ensureClientSideSelectorSupport() {
    var _this = this;

    return this.execute('return !!document.evaluate;').then(function (res) {
        if (res.value) {
            return true;
        }

        /**
         * Don't read in unless necessary
         */
        if (!wgxpathSrc) {
            wgxpathSrc = _fs2['default'].readFileSync(WGXPATH_PATH);
            wgxpathSrc = wgxpathSrc.toString().split('module.exports')[0];
        }

        return _this.execute(wgxpathSrc + '\nwgxpath.install(window);');
    });
};

exports['default'] = ensureClientSideSelectorSupport;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9oZWxwZXJzL2Vuc3VyZUNsaWVudFNpZGVTZWxlY3RvclN1cHBvcnQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7a0JBQWUsSUFBSTs7OztBQUVuQixJQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFBOztBQUUvQyxJQUFJLFVBQVUsWUFBQSxDQUFBOzs7OztBQUtkLElBQUksK0JBQStCLEdBQUcsU0FBbEMsK0JBQStCLEdBQWU7OztBQUM5QyxXQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsNkJBQTZCLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxHQUFHLEVBQUs7QUFDN0QsWUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFO0FBQ1gsbUJBQU8sSUFBSSxDQUFBO1NBQ2Q7Ozs7O0FBS0QsWUFBSSxDQUFDLFVBQVUsRUFBRTtBQUNiLHNCQUFVLEdBQUcsZ0JBQUcsWUFBWSxDQUFDLFlBQVksQ0FBQyxDQUFBO0FBQzFDLHNCQUFVLEdBQUcsVUFBVSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO1NBQ2hFOztBQUVELGVBQU8sTUFBSyxPQUFPLENBQUMsVUFBVSxHQUFHLDRCQUE0QixDQUFDLENBQUE7S0FDakUsQ0FBQyxDQUFBO0NBQ0wsQ0FBQTs7cUJBRWMsK0JBQStCIiwiZmlsZSI6ImVuc3VyZUNsaWVudFNpZGVTZWxlY3RvclN1cHBvcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnXG5cbmNvbnN0IFdHWFBBVEhfUEFUSCA9IHJlcXVpcmUucmVzb2x2ZSgnd2d4cGF0aCcpXG5cbmxldCB3Z3hwYXRoU3JjXG5cbi8qKlxuICogRW5zdXJlcyBkb2N1bWVudC5ldmFsdWF0ZSgpIGluIHRoZSBicm93c2VyLlxuICovXG5sZXQgZW5zdXJlQ2xpZW50U2lkZVNlbGVjdG9yU3VwcG9ydCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlKCdyZXR1cm4gISFkb2N1bWVudC5ldmFsdWF0ZTsnKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy52YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEb24ndCByZWFkIGluIHVubGVzcyBuZWNlc3NhcnlcbiAgICAgICAgICovXG4gICAgICAgIGlmICghd2d4cGF0aFNyYykge1xuICAgICAgICAgICAgd2d4cGF0aFNyYyA9IGZzLnJlYWRGaWxlU3luYyhXR1hQQVRIX1BBVEgpXG4gICAgICAgICAgICB3Z3hwYXRoU3JjID0gd2d4cGF0aFNyYy50b1N0cmluZygpLnNwbGl0KCdtb2R1bGUuZXhwb3J0cycpWzBdXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5leGVjdXRlKHdneHBhdGhTcmMgKyAnXFxud2d4cGF0aC5pbnN0YWxsKHdpbmRvdyk7JylcbiAgICB9KVxufVxuXG5leHBvcnQgZGVmYXVsdCBlbnN1cmVDbGllbnRTaWRlU2VsZWN0b3JTdXBwb3J0XG4iXX0=
